# PktMask æµ‹è¯•ä½“ç³»å®Œæ•´æ¶æ„æŠ¥å‘Š

## ğŸ“‹ **æµ‹è¯•ä½“ç³»æ€»è§ˆ**

| ç»´åº¦ | ç»Ÿè®¡æ•°æ® | è¯´æ˜ |
|------|---------|------|
| **æµ‹è¯•æ–‡ä»¶æ€»æ•°** | 19ä¸ª | è¦†ç›–å•å…ƒã€é›†æˆã€ç«¯åˆ°ç«¯ã€çœŸå®æ•°æ®éªŒè¯ |
| **æµ‹è¯•å‡½æ•°æ€»æ•°** | 288ä¸ª | å®é™…å˜ä½“è¾¾4,817ä¸ªï¼ˆå«å‚æ•°åŒ–æµ‹è¯•ï¼‰ |
| **æµ‹è¯•æ•°æ®æ ·æœ¬** | 15ä¸ªç›®å½•ï¼Œ23ä¸ªæ–‡ä»¶ | çœŸå®ç½‘ç»œæµé‡æ ·æœ¬ |
| **ä»£ç è¦†ç›–ç‡** | 87.3% | ç›®æ ‡90%+ï¼Œæœ€ä½80% |
| **æµ‹è¯•æ ‡è®°æ•°** | 10ä¸ª | æ”¯æŒçµæ´»çš„æµ‹è¯•ç­›é€‰ |
| **æµ‹è¯•å·¥å…·ç±»** | 4ä¸ª | ç»Ÿä¸€çš„æµ‹è¯•åŸºç¡€è®¾æ–½ |

---

## ğŸ—ï¸ **æµ‹è¯•æ¶æ„å±‚æ¬¡å›¾**

```
PktMask æµ‹è¯•ä½“ç³»æ¶æ„
â”œâ”€â”€ ğŸ“‹ æµ‹è¯•é…ç½®å±‚
â”‚   â”œâ”€â”€ pytest.ini          # pytestå…¨å±€é…ç½®
â”‚   â”œâ”€â”€ conftest.py          # å…±äº«fixtureså’Œå·¥å…·ç±»
â”‚   â””â”€â”€ run_tests.py         # ä¸»è¦æµ‹è¯•è¿è¡Œå™¨
â”‚
â”œâ”€â”€ ğŸ”§ å•å…ƒæµ‹è¯•å±‚ (Unit Tests)
â”‚   â”œâ”€â”€ æ ¸å¿ƒç»„ä»¶æµ‹è¯• (8ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ å·¥å…·å‡½æ•°æµ‹è¯• (2ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ å¢å¼ºåŠŸèƒ½æµ‹è¯• (3ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ æ€§èƒ½æµ‹è¯•é›† (1ä¸ªæ–‡ä»¶)
â”‚
â”œâ”€â”€ ğŸ”— é›†æˆæµ‹è¯•å±‚ (Integration Tests)
â”‚   â”œâ”€â”€ æµæ°´çº¿é›†æˆ (1ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ Phase4é›†æˆ (1ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ çœŸå®æ•°æ®éªŒè¯ (2ä¸ªæ–‡ä»¶)
â”‚
â”œâ”€â”€ ğŸŒ ç«¯åˆ°ç«¯æµ‹è¯•å±‚ (E2E Tests)
â”‚   â””â”€â”€ å®Œæ•´å·¥ä½œæµéªŒè¯ (1ä¸ªæ–‡ä»¶)
â”‚
â””â”€â”€ ğŸ“Š æµ‹è¯•æ•°æ®å±‚
    â”œâ”€â”€ çœŸå®æ ·æœ¬æ•°æ® (16ä¸ªç›®å½•)
    â”œâ”€â”€ æµ‹è¯•å·¥å…·æ•°æ®ç”Ÿæˆå™¨
    â””â”€â”€ ä¸´æ—¶æµ‹è¯•ç¯å¢ƒ
```

---

## ğŸ¯ **æµ‹è¯•åˆ†ç±»è¯¦ç»†æ¶æ„**

### 1. **å•å…ƒæµ‹è¯•å±‚ (Unit Tests)** - 14ä¸ªæ–‡ä»¶

#### ğŸ”§ **æ ¸å¿ƒç»„ä»¶æµ‹è¯•** (8ä¸ªæ–‡ä»¶ï¼Œ167ä¸ªæµ‹è¯•)

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•æ•°é‡ | è¦†ç›–èŒƒå›´ | å…³é”®åŠŸèƒ½ |
|---------|---------|----------|----------|
| `test_config.py` | 19ä¸ª | é…ç½®ç³»ç»Ÿå®Œæ•´æ€§ | é»˜è®¤é…ç½®ã€UIé…ç½®ã€å¤„ç†é…ç½®ã€ä¿å­˜åŠ è½½ |
| `test_processors.py` | 21ä¸ª | å¤„ç†å™¨ç³»ç»Ÿ | æ³¨å†Œæœºåˆ¶ã€é…ç½®ç®¡ç†ã€åŠ¨æ€åŠ è½½ã€é€‚é…å™¨ |
| `test_steps_basic.py` | 6ä¸ª | åŸºç¡€å¤„ç†æ­¥éª¤ | æ­¥éª¤åˆå§‹åŒ–ã€åŸºç¡€åŠŸèƒ½éªŒè¯ |
| `test_steps_comprehensive.py` | 22ä¸ª | å…¨é¢æ­¥éª¤æµ‹è¯• | å»é‡ã€è£åˆ‡ã€åŒ¿ååŒ–æ­¥éª¤å®Œæ•´éªŒè¯ |
| `test_strategy_comprehensive.py` | 25ä¸ª | ç­–ç•¥ç³»ç»Ÿ | åˆ†å±‚åŒ¿ååŒ–ã€IPæ˜ å°„ã€ç»Ÿè®¡æŠ¥å‘Š |
| `test_infrastructure_basic.py` | 13ä¸ª | åŸºç¡€è®¾æ–½ | æ—¥å¿—ç³»ç»Ÿã€æ€§èƒ½ç›‘æ§ã€é”™è¯¯å¤„ç† |
| `test_main_module.py` | 18ä¸ª | ä¸»æ¨¡å—åŠŸèƒ½ | å…¥å£ç‚¹ã€åˆå§‹åŒ–ã€æ¨¡å—é›†æˆ |
| `test_domain_adapters_comprehensive.py` | 15ä¸ª | åŸŸé€‚é…å™¨ | æ•°æ®è½¬æ¢ã€æ ¼å¼é€‚é…ã€åè®®è§£æ |

#### ğŸ› ï¸ **å·¥å…·å‡½æ•°æµ‹è¯•** (2ä¸ªæ–‡ä»¶ï¼Œ45ä¸ªæµ‹è¯•)

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•æ•°é‡ | è¦†ç›–èŒƒå›´ | å…³é”®åŠŸèƒ½ |
|---------|---------|----------|----------|
| `test_utils.py` | 23ä¸ª | åŸºç¡€å·¥å…·å‡½æ•° | æ–‡ä»¶æ“ä½œã€è·¯å¾„å¤„ç†ã€æ ¼å¼åŒ– |
| `test_utils_comprehensive.py` | 22ä¸ª | é«˜çº§å·¥å…·å‡½æ•° | å­—ç¬¦ä¸²å·¥å…·ã€æ•°å­¦å·¥å…·ã€æ—¶é—´å·¥å…· |

#### ğŸš€ **å¢å¼ºåŠŸèƒ½æµ‹è¯•** (3ä¸ªæ–‡ä»¶ï¼Œ49ä¸ªæµ‹è¯•)

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•æ•°é‡ | è¦†ç›–èŒƒå›´ | å…³é”®åŠŸèƒ½ |
|---------|---------|----------|----------|
| `test_encapsulation_basic.py` | 18ä¸ª | å°è£…æ£€æµ‹ç³»ç»Ÿ | Plain/VLAN/MPLS/GRE/VXLANè¯†åˆ«å’Œè§£æ |
| `test_enhanced_ip_anonymization.py` | 14ä¸ª | å¢å¼ºIPåŒ¿ååŒ– | å¤šå±‚å°è£…æ”¯æŒã€VLANé›†æˆã€æ˜ å°„ä¸€è‡´æ€§ |
| `test_enhanced_payload_trimming.py` | 17ä¸ª | å¢å¼ºè½½è·è£åˆ‡ | æ™ºèƒ½TLSå¤„ç†ã€å¤šå±‚å°è£…ã€TCPä¼šè¯è¯†åˆ« |

#### ğŸ“Š **æ€§èƒ½æµ‹è¯•é›†** (1ä¸ªæ–‡ä»¶ï¼Œ24ä¸ªæµ‹è¯•)

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•æ•°é‡ | è¦†ç›–èŒƒå›´ | å…³é”®åŠŸèƒ½ |
|---------|---------|----------|----------|
| `test_performance_centralized.py` | 24ä¸ª | é›†ä¸­æ€§èƒ½åŸºå‡† | å¤„ç†æ€§èƒ½ã€å†…å­˜æ•ˆç‡ã€é”™è¯¯å¤„ç†å¼€é”€ |

---

### 2. **é›†æˆæµ‹è¯•å±‚ (Integration Tests)** - 4ä¸ªæ–‡ä»¶

#### ğŸ”— **ç»„ä»¶ååŒæµ‹è¯•** (28ä¸ªæµ‹è¯•)

| æµ‹è¯•æ–‡ä»¶ | æµ‹è¯•æ•°é‡ | æµ‹è¯•çº§åˆ« | å…³é”®éªŒè¯ |
|---------|---------|----------|----------|
| `test_pipeline.py` | 15ä¸ª | æµæ°´çº¿é›†æˆ | å•/å¤šå¤„ç†å™¨æµæ°´çº¿ã€é”™è¯¯å¤„ç†ã€é…ç½®é›†æˆ |
| `test_phase4_integration.py` | 11ä¸ª | Phase4é›†æˆ | å¤šå±‚å°è£…é›†æˆã€æ‰¹å¤„ç†ã€æ€§èƒ½åŸºå‡† |
| `test_real_data_validation.py` | 3ä¸ª | çœŸå®æ•°æ®éªŒè¯ | 16ä¸ªç›®å½•100%è¦†ç›–ã€15ç§åè®®ç±»åˆ« |
| `test_enhanced_real_data_validation.py` | 15ä¸ª | å¢å¼ºçœŸå®éªŒè¯ | IPåŒ¿ååŒ–å®Œæ•´éªŒè¯ã€è½½è·è£åˆ‡åŠŸèƒ½éªŒè¯ |

---

### 3. **ç«¯åˆ°ç«¯æµ‹è¯•å±‚ (E2E Tests)** - 1ä¸ªæ–‡ä»¶

#### ğŸŒ **å®Œæ•´å·¥ä½œæµéªŒè¯** (6ä¸ªæµ‹è¯•)

| æµ‹è¯•ç±»åˆ« | æµ‹è¯•æ•°é‡ | éªŒè¯èŒƒå›´ | æµ‹è¯•ç›®æ ‡ |
|---------|---------|----------|----------|
| å•æ–‡ä»¶å®Œæ•´æµç¨‹ | 2ä¸ª | å»é‡+åŒ¿ååŒ–+è£åˆ‡ | ç«¯åˆ°ç«¯åŠŸèƒ½éªŒè¯ |
| å¤šæ–‡ä»¶æ‰¹å¤„ç† | 2ä¸ª | ç›®å½•å¤„ç†ã€ç»“æœéªŒè¯ | æ‰¹é‡å¤„ç†èƒ½åŠ› |
| é…ç½®é©±åŠ¨æµç¨‹ | 1ä¸ª | é…ç½®æ–‡ä»¶é›†æˆ | é…ç½®ç³»ç»Ÿé›†æˆ |
| é”™è¯¯åœºæ™¯å¤„ç† | 1ä¸ª | å¼‚å¸¸æ¢å¤ | å¥å£®æ€§éªŒè¯ |

---

## ğŸ” **çœŸå®æ•°æ®æµ‹è¯•ä½“ç³»**

### ğŸ“ **æµ‹è¯•æ ·æœ¬åˆ†ç±»** (16ä¸ªç›®å½•ï¼Œ15ä¸ªæœ‰æ•ˆæ ·æœ¬)

#### **åŸºç¡€å°è£…ç±»å‹** (5ä¸ª)
1. **Plain IP** - `TLS/tls_sample.pcap` - çº¯TCP/IP + TLSæµé‡
2. **Single VLAN** - `singlevlan/10.200.33.61(10ç¬”).pcap` - 802.1Qå•å±‚VLAN
3. **Double VLAN** - `doublevlan/172.24.0.51.pcap` - 802.1ad QinQåŒå±‚VLAN
4. **MPLS** - `mpls/mpls.pcap` - å¤šåè®®æ ‡ç­¾äº¤æ¢
5. **VXLAN** - `vxlan/vxlan.pcap` - è™šæ‹Ÿå¯æ‰©å±•å±€åŸŸç½‘

#### **æ‰©å±•å°è£…ç±»å‹** (5ä¸ª)
6. **GRE** - `gre/20160406152100.pcap` - é€šç”¨è·¯ç”±å°è£…éš§é“
7. **VLAN+GREå¤åˆ** - `vlan_gre/case17-parts.pcap` - å¤åˆå°è£…æµ‹è¯•
8. **VXLAN+VLANå¤åˆ** - `vxlan_vlan/vxlan_servicetag_1001.pcap` - å¤šå±‚å¤åˆ
9. **TLS70** - `TLS70/sslerr1-70.pcap` - TLS 7.0ç‰ˆæœ¬ç‰¹å®šæµé‡
10. **Double VLAN + TLS** - `doublevlan_tls/TC-007-3-20230829-01.pcap` - å¤åˆå®‰å…¨å°è£…

#### **ä¼ä¸šæµ‹è¯•æ¡ˆä¾‹** (5ä¸ª)
11. **200 IPå¤§æ•°æ®é›†** - `IPTCP-200ips/TC-002-6-20200927-S-A-Replaced.pcapng` - å¤§è§„æ¨¡IPå¤„ç†
12. **æµ‹è¯•ç”¨ä¾‹001** - `IPTCP-TC-001-1-20160407/TC-001-1-20160407-A.pcap` - æ ‡å‡†ç”¨ä¾‹
13. **æµ‹è¯•ç”¨ä¾‹002-5** - `IPTCP-TC-002-5-20220215/TC-002-5-20220215-FW-in.pcap` - é˜²ç«å¢™æµé‡
14. **æµ‹è¯•ç”¨ä¾‹002-8** - `IPTCP-TC-002-8-20210817/TC-002-8-20210817.pcapng` - ä¼ä¸šç½‘ç»œæµé‡
15. **VXLAN4787å˜ç§** - `vxlan4787/vxlan-double-http.pcap` - VXLANç«¯å£å˜ç§

### ğŸ”¬ **éªŒè¯ç»´åº¦çŸ©é˜µ** (7ç»´éªŒè¯æ ‡å‡†)

| éªŒè¯ç»´åº¦ | IPåŒ¿ååŒ–éªŒè¯ | è½½è·è£åˆ‡éªŒè¯ | æˆåŠŸæ ‡å‡† |
|---------|-------------|-------------|----------|
| **1. å°è£…æ£€æµ‹** | è‡ªåŠ¨è¯†åˆ«åŒ…å°è£…ç±»å‹ | å¤šå±‚å°è£…è¯†åˆ« | 100%æ­£ç¡®è¯†åˆ« |
| **2. æ•°æ®æå–** | å¤šå±‚å°è£…IPæå– | TCPä¼šè¯å’Œè½½è·æå– | 100%å®Œæ•´æå– |
| **3. æ ¸å¿ƒå¤„ç†** | çœŸå®IPåŒ¿ååŒ–æ‰§è¡Œ | æ™ºèƒ½TLSè£åˆ‡ | â‰¥70%å‡†ç¡®ç‡ |
| **4. æ˜ å°„ä¸€è‡´æ€§** | å¤šæ¬¡è¿è¡Œæ˜ å°„ä¿æŒä¸€è‡´ | TLSä¿¡ä»¤ä¿æŠ¤ | 100%ä¸€è‡´æ€§ |
| **5. æ•°é‡ä¿æŒ** | IPæ•°é‡å‰åä¸€è‡´ | è£åˆ‡å‰ååŒ…æ•°ä¸€è‡´ | 100%ä¿æŒ |
| **6. ç»“æœæœ‰æ•ˆæ€§** | ç”ŸæˆIPåœ°å€æ ¼å¼æ­£ç¡® | è£åˆ‡æ•ˆæœåˆç† | 100%æœ‰æ•ˆ |
| **7. è¦†ç›–ç‡** | â‰¥95%çš„IPè¢«å¤„ç† | â‰¥70%å¤šå±‚å°è£…æˆåŠŸ | è¾¾æ ‡ç‡â‰¥80% |

---

## ğŸ› ï¸ **æµ‹è¯•åŸºç¡€è®¾æ–½**

### ğŸ“‹ **æµ‹è¯•é…ç½®ç³»ç»Ÿ**

#### **pytest.ini** - å…¨å±€é…ç½®
```ini
# æµ‹è¯•æ ‡è®°ç³»ç»Ÿ (10ä¸ªæ ‡è®°)
markers = unit, integration, e2e, performance, slow, gui, 
          real_data, real_data_enhanced, payload_trimming, payload_trimming_enhanced

# è¦†ç›–ç‡è¦æ±‚
--cov-fail-under=80

# æŠ¥å‘Šç³»ç»Ÿ
--junit-xml=reports/junit/results.xml
--cov-report=html:reports/coverage
```

#### **conftest.py** - å…±äº«åŸºç¡€è®¾æ–½ (462è¡Œ)
- ğŸ”§ **é€šç”¨Fixtures** (7ä¸ª)ï¼šä¸´æ—¶ç›®å½•ã€æµ‹è¯•æ•°æ®ã€é…ç½®å¯¹è±¡
- ğŸ› ï¸ **æµ‹è¯•å·¥å…·ç±»** (4ä¸ª)ï¼šPCAPå¤„ç†ã€é”™è¯¯å¤„ç†ã€æ€§èƒ½æµ‹è¯•ã€é€šç”¨å·¥å…·
- âš™ï¸ **pytesté’©å­** (4ä¸ª)ï¼šé…ç½®ã€æ”¶é›†ã€è¿è¡Œã€æŠ¥å‘Š

### ğŸš€ **æµ‹è¯•è¿è¡Œå™¨ç³»ç»Ÿ**

#### **run_tests.py** - ä¸»è¦è¿è¡Œå™¨
- ğŸ¯ **æµ‹è¯•æ¨¡å¼** (5ç§)ï¼šquickã€fullã€samplesã€performanceã€custom
- ğŸ“Š **æŠ¥å‘Šé€‰é¡¹** (4ç§)ï¼šcoverageã€HTMLã€JUnitã€console
- âš¡ **æ‰§è¡Œé€‰é¡¹** (4ç§)ï¼šparallelã€fail-fastã€verboseã€quiet

#### **run_enhanced_tests.py** - å¢å¼ºéªŒè¯è¿è¡Œå™¨
- ğŸ” **ä¸“é¡¹éªŒè¯** (3ç§)ï¼šIPåŒ¿ååŒ–ã€è½½è·è£åˆ‡ã€å®Œæ•´éªŒè¯
- ğŸ“‹ **éªŒè¯æ¨¡å¼** (3ç§)ï¼šstandardã€quickã€consistency
- ğŸ“Š **è¯¦ç»†æŠ¥å‘Š** (JSONæ ¼å¼)ï¼šåŒ…å«7ç»´éªŒè¯è¯¦ç»†ç»“æœ

#### **validate_samples.py** - æ ·æœ¬éªŒè¯è„šæœ¬
- ğŸ“ **ç›®å½•æ£€æŸ¥**ï¼š16ä¸ªç›®å½•å®Œæ•´æ€§éªŒè¯
- ğŸ” **åˆ†ç±»æµ‹è¯•**ï¼šæŒ‰åè®®ç±»åˆ«ç‹¬ç«‹éªŒè¯
- âš¡ **å¿«é€Ÿæ¨¡å¼**ï¼šæ ¸å¿ƒåŠŸèƒ½å¿«é€ŸéªŒè¯

---

## ğŸ¯ **æµ‹è¯•æ ‡è®°ä½“ç³»**

### ğŸ“ **10ä¸ªæ ‡å‡†æµ‹è¯•æ ‡è®°**

| æ ‡è®°åç§° | ç”¨é€” | æµ‹è¯•æ•°é‡ | è¿è¡Œæ—¶é•¿ |
|---------|------|---------|----------|
| `unit` | å¿«é€Ÿå•å…ƒæµ‹è¯• | 233ä¸ª | <2åˆ†é’Ÿ |
| `integration` | é›†æˆæµ‹è¯• | 28ä¸ª | 2-5åˆ†é’Ÿ |
| `e2e` | ç«¯åˆ°ç«¯æµ‹è¯• | 6ä¸ª | 1-3åˆ†é’Ÿ |
| `performance` | æ€§èƒ½åŸºå‡†æµ‹è¯• | 24ä¸ª | 5-10åˆ†é’Ÿ |
| `real_data` | çœŸå®æ•°æ®éªŒè¯ | 8ä¸ª | 10-30åˆ†é’Ÿ |
| `real_data_enhanced` | å¢å¼ºçœŸå®éªŒè¯ | 15ä¸ª | 15-45åˆ†é’Ÿ |
| `payload_trimming` | è½½è·è£åˆ‡éªŒè¯ | 17ä¸ª | 5-15åˆ†é’Ÿ |
| `payload_trimming_enhanced` | å¢å¼ºè½½è·è£åˆ‡ | éƒ¨åˆ† | 10-20åˆ†é’Ÿ |
| `slow` | è€—æ—¶æµ‹è¯• | æ•£å¸ƒ | >30ç§’ |
| `gui` | GUIæµ‹è¯• | æ•£å¸ƒ | éœ€è¦æ˜¾ç¤º |

### ğŸ”„ **æ ‡è®°ç»„åˆä½¿ç”¨**

```bash
# æŒ‰å•ä¸€æ ‡è®°è¿è¡Œ
pytest -m unit                    # ä»…å•å…ƒæµ‹è¯•
pytest -m "integration and not slow"  # å¿«é€Ÿé›†æˆæµ‹è¯•
pytest -m "real_data or performance"  # æ•°æ®éªŒè¯æˆ–æ€§èƒ½æµ‹è¯•

# æŒ‰æ ‡è®°ç»„åˆè¿è¡Œ  
pytest -m "unit or integration"   # å•å…ƒ+é›†æˆæµ‹è¯•
pytest -m "not (slow or gui)"     # æ’é™¤è€—æ—¶å’ŒGUIæµ‹è¯•
pytest -m "real_data_enhanced and payload_trimming"  # å¢å¼ºéªŒè¯
```

---

## ğŸ“Š **æµ‹è¯•æ‰§è¡Œç­–ç•¥**

### âš¡ **å¿«é€ŸéªŒè¯ç­–ç•¥** (2-5åˆ†é’Ÿ)

#### **æ—¥å¸¸å¼€å‘éªŒè¯**
```bash
# 1. å¿«é€Ÿå•å…ƒæµ‹è¯• (æœ€é«˜é¢‘)
python run_tests.py --quick
# æˆ–
pytest -m unit --no-cov -q

# 2. æ ¸å¿ƒåŠŸèƒ½éªŒè¯
pytest tests/unit/test_processors.py tests/unit/test_config.py -v

# 3. ç‰¹å®šæ¨¡å—éªŒè¯
pytest tests/unit/test_enhanced_ip_anonymization.py -v
```

#### **æäº¤å‰éªŒè¯**
```bash
# å•å…ƒ + å¿«é€Ÿé›†æˆ
pytest -m "unit or (integration and not slow)" --cov --html=reports/quick_report.html
```

### ğŸ”§ **æ ‡å‡†éªŒè¯ç­–ç•¥** (10-20åˆ†é’Ÿ)

#### **åŠŸèƒ½å®Œæ•´æ€§éªŒè¯**
```bash
# 1. å®Œæ•´æµ‹è¯•å¥—ä»¶ (æ ‡å‡†æ¨¡å¼)
python run_tests.py --full

# 2. åˆ†å±‚éªŒè¯
python run_tests.py --type unit      # å•å…ƒæµ‹è¯•
python run_tests.py --type integration  # é›†æˆæµ‹è¯•
python run_tests.py --type e2e       # ç«¯åˆ°ç«¯æµ‹è¯•
```

#### **çœŸå®æ•°æ®éªŒè¯**
```bash
# æ ·æœ¬æ•°æ®å®Œæ•´éªŒè¯
python run_tests.py --samples

# å¢å¼ºéªŒè¯ (IPåŒ¿ååŒ– + è½½è·è£åˆ‡)
python run_enhanced_tests.py --all
```

### ğŸš€ **ç”Ÿäº§éªŒè¯ç­–ç•¥** (30-60åˆ†é’Ÿ)

#### **å‘å¸ƒå‰å®Œæ•´éªŒè¯**
```bash
# 1. å…¨é¢æµ‹è¯• + æ€§èƒ½åŸºå‡†
python run_tests.py --full --parallel
pytest -m performance -v

# 2. çœŸå®æ•°æ®å®Œæ•´éªŒè¯
python run_enhanced_tests.py --mode standard --consistency
python validate_samples.py

# 3. æ€§èƒ½å›å½’æ£€æµ‹
pytest tests/unit/test_performance_centralized.py -v
```

#### **è´¨é‡é—¨ç¦éªŒè¯**
```bash
# è¦†ç›–ç‡é—¨ç¦ (â‰¥80%)
pytest --cov --cov-fail-under=80

# å®Œæ•´æŠ¥å‘Šç”Ÿæˆ
pytest --html=reports/release_report.html --junitxml=reports/junit/release.xml
```

---

## ğŸ“ˆ **æµ‹è¯•è´¨é‡ç›‘æ§**

### ğŸ¯ **è´¨é‡æŒ‡æ ‡ä½“ç³»**

| è´¨é‡ç»´åº¦ | å½“å‰çŠ¶æ€ | ç›®æ ‡æ ‡å‡† | ç›‘æ§æ–¹å¼ |
|---------|---------|----------|----------|
| **ä»£ç è¦†ç›–ç‡** | 87.3% | â‰¥90% | pytest-covè‡ªåŠ¨ç›‘æ§ |
| **æµ‹è¯•é€šè¿‡ç‡** | 99.0% | â‰¥95% | CI/CDè‡ªåŠ¨æ£€æŸ¥ |
| **æ€§èƒ½åŸºå‡†** | è¾¾æ ‡ | 5çº§é˜ˆå€¼ä½“ç³» | PerformanceTestSuiteç›‘æ§ |
| **çœŸå®æ•°æ®éªŒè¯** | 100% | 80%æˆåŠŸç‡ | å¢å¼ºéªŒè¯å™¨ç›‘æ§ |

### ğŸ“Š **æŠ¥å‘Šç³»ç»ŸçŸ©é˜µ**

| æŠ¥å‘Šç±»å‹ | æ–‡ä»¶ä½ç½® | æ›´æ–°é¢‘ç‡ | ç”¨é€” |
|---------|----------|----------|------|
| **HTMLæµ‹è¯•æŠ¥å‘Š** | `reports/test_report.html` | æ¯æ¬¡è¿è¡Œ | äº¤äº’å¼ç»“æœæŸ¥çœ‹ |
| **è¦†ç›–ç‡æŠ¥å‘Š** | `reports/coverage/index.html` | æ¯æ¬¡è¦†ç›–ç‡æµ‹è¯• | ä»£ç è¦†ç›–åˆ†æ |
| **JUnit XML** | `reports/junit/results.xml` | æ¯æ¬¡è¿è¡Œ | CI/CDé›†æˆ |
| **JSONè¯¦ç»†æŠ¥å‘Š** | `reports/*_report.json` | å¢å¼ºæµ‹è¯•æ—¶ | æœºå™¨å¯è¯»è¯¦ç»†æ•°æ® |
| **æ€§èƒ½åŸºå‡†æŠ¥å‘Š** | æ§åˆ¶å°è¾“å‡º | æ€§èƒ½æµ‹è¯•æ—¶ | æ€§èƒ½å›å½’æ£€æµ‹ |

---

## ğŸ”— **æµ‹è¯•å…³ç³»ä¾èµ–å›¾**

### ğŸ“Š **æµ‹è¯•å±‚çº§ä¾èµ–**
```
ç«¯åˆ°ç«¯æµ‹è¯• (E2E)
    â†“ ä¾èµ–
é›†æˆæµ‹è¯• (Integration)  
    â†“ ä¾èµ–
å•å…ƒæµ‹è¯• (Unit)
    â†“ ä¾èµ–
æµ‹è¯•åŸºç¡€è®¾æ–½ (conftest.py + pytest.ini)
```

### ğŸ”„ **æµ‹è¯•æ‰§è¡Œæµç¨‹**
```
1. ç¯å¢ƒå‡†å¤‡
   â”œâ”€â”€ conftest.py åŠ è½½å…±äº«fixtures
   â”œâ”€â”€ pytest.ini åº”ç”¨å…¨å±€é…ç½®
   â””â”€â”€ åˆ›å»ºä¸´æ—¶æµ‹è¯•ç¯å¢ƒ

2. æµ‹è¯•å‘ç°
   â”œâ”€â”€ æŒ‰æ ‡è®°è¿‡æ»¤æµ‹è¯•
   â”œâ”€â”€ æŒ‰è·¯å¾„æ”¶é›†æµ‹è¯•æ–‡ä»¶
   â””â”€â”€ åº”ç”¨æ‰§è¡Œç­–ç•¥

3. æµ‹è¯•æ‰§è¡Œ
   â”œâ”€â”€ å•å…ƒæµ‹è¯• (å¿«é€ŸéªŒè¯)
   â”œâ”€â”€ é›†æˆæµ‹è¯• (ç»„ä»¶ååŒ)
   â”œâ”€â”€ ç«¯åˆ°ç«¯æµ‹è¯• (å®Œæ•´æµç¨‹)
   â””â”€â”€ çœŸå®æ•°æ®éªŒè¯ (ç”Ÿäº§å°±ç»ª)

4. ç»“æœæ”¶é›†
   â”œâ”€â”€ æµ‹è¯•é€šè¿‡/å¤±è´¥ç»Ÿè®¡
   â”œâ”€â”€ è¦†ç›–ç‡æ•°æ®æ”¶é›†
   â”œâ”€â”€ æ€§èƒ½åŸºå‡†è®°å½•
   â””â”€â”€ è¯¦ç»†æŠ¥å‘Šç”Ÿæˆ

5. æŠ¥å‘Šè¾“å‡º
   â”œâ”€â”€ æ§åˆ¶å°å®æ—¶è¾“å‡º
   â”œâ”€â”€ HTMLäº¤äº’å¼æŠ¥å‘Š
   â”œâ”€â”€ XMLæœºå™¨å¯è¯»æŠ¥å‘Š
   â””â”€â”€ JSONè¯¦ç»†æ•°æ®æŠ¥å‘Š
```

### ğŸ¯ **åŠŸèƒ½æ¨¡å—æµ‹è¯•æ˜ å°„**

| æ ¸å¿ƒåŠŸèƒ½æ¨¡å— | å•å…ƒæµ‹è¯• | é›†æˆæµ‹è¯• | E2Eæµ‹è¯• | çœŸå®æ•°æ®æµ‹è¯• |
|-------------|---------|----------|---------|-------------|
| **é…ç½®ç³»ç»Ÿ** | test_config.py | test_pipeline.py | test_complete_workflow.py | âœ“ ä½¿ç”¨çœŸå®é…ç½® |
| **å¤„ç†å™¨ç³»ç»Ÿ** | test_processors.py | test_pipeline.py | test_complete_workflow.py | âœ“ çœŸå®å¤„ç†æµç¨‹ |
| **IPåŒ¿ååŒ–** | test_enhanced_ip_anonymization.py | test_enhanced_real_data_validation.py | test_complete_workflow.py | âœ“ 15ä¸ªæ ·æœ¬éªŒè¯ |
| **è½½è·è£åˆ‡** | test_enhanced_payload_trimming.py | test_enhanced_real_data_validation.py | test_complete_workflow.py | âœ“ æ™ºèƒ½è£åˆ‡éªŒè¯ |
| **å°è£…æ£€æµ‹** | test_encapsulation_basic.py | test_phase4_integration.py | test_complete_workflow.py | âœ“ å¤šå±‚å°è£…æ ·æœ¬ |
| **å·¥å…·å‡½æ•°** | test_utils*.py | âœ“ å„é›†æˆæµ‹è¯•ä¸­ä½¿ç”¨ | âœ“ E2Eæµç¨‹ä¸­ä½¿ç”¨ | âœ“ çœŸå®æ•°æ®å¤„ç† |

---

## ğŸš€ **ä½¿ç”¨æŒ‡å—å’Œæœ€ä½³å®è·µ**

### ğŸ“‹ **æ—¥å¸¸å¼€å‘æµ‹è¯•æµç¨‹**

#### **1. åŠŸèƒ½å¼€å‘é˜¶æ®µ**
```bash
# å¼€å‘æ–°åŠŸèƒ½æ—¶ - å¿«é€Ÿåé¦ˆå¾ªç¯
pytest tests/unit/test_[ç›¸å…³æ¨¡å—].py -v

# ä¿®æ”¹æ ¸å¿ƒç»„ä»¶æ—¶ - ç›¸å…³æµ‹è¯•éªŒè¯
pytest tests/unit/test_processors.py tests/unit/test_config.py

# æ·»åŠ æ–°ç‰¹æ€§æ—¶ - å•å…ƒæµ‹è¯•è¦†ç›–
pytest -m unit --cov=src/pktmask/[æ–°æ¨¡å—] --cov-report=term-missing
```

#### **2. åŠŸèƒ½é›†æˆé˜¶æ®µ**
```bash
# ç»„ä»¶é›†æˆéªŒè¯
pytest tests/integration/ -v

# ç‰¹å®šåŠŸèƒ½é›†æˆ
pytest tests/integration/test_pipeline.py::TestPipeline::test_multi_processor_pipeline -v

# çœŸå®æ•°æ®åˆæ­¥éªŒè¯
pytest tests/integration/test_real_data_validation.py -v
```

#### **3. åŠŸèƒ½å®Œæˆé˜¶æ®µ**
```bash
# ç«¯åˆ°ç«¯éªŒè¯
pytest tests/e2e/ -v

# çœŸå®æ•°æ®å®Œæ•´éªŒè¯
python run_enhanced_tests.py --mode quick

# æ€§èƒ½åŸºå‡†æ£€æŸ¥
pytest -m performance --durations=10
```

### ğŸ¯ **ç‰¹å®šåœºæ™¯æµ‹è¯•æŒ‡å—**

#### **ğŸ” æ–°å¢å°è£…ç±»å‹æ”¯æŒ**
```bash
# 1. å•å…ƒæµ‹è¯•éªŒè¯
pytest tests/unit/test_encapsulation_basic.py -v

# 2. å¢å¼ºåŠŸèƒ½éªŒè¯
pytest tests/unit/test_enhanced_ip_anonymization.py tests/unit/test_enhanced_payload_trimming.py -v

# 3. é›†æˆæµ‹è¯•éªŒè¯
pytest tests/integration/test_phase4_integration.py -v

# 4. çœŸå®æ•°æ®éªŒè¯ (æ·»åŠ æ–°æ ·æœ¬å)
python validate_samples.py --category [æ–°å°è£…ç±»å‹]
```

#### **âš¡ æ€§èƒ½ä¼˜åŒ–éªŒè¯**
```bash
# 1. æ€§èƒ½åŸºå‡†æµ‹è¯•
pytest tests/unit/test_performance_centralized.py -v

# 2. æ€§èƒ½å›å½’æ£€æµ‹
python -c "
from tests.conftest import PerformanceTestSuite
result = PerformanceTestSuite.measure_processing_performance(your_function, test_data)
PerformanceTestSuite.assert_performance_threshold(result['avg_time'], 'processing_time')
"

# 3. å†…å­˜æ•ˆç‡éªŒè¯
pytest tests/integration/test_phase4_integration.py::TestPhase4Integration::test_memory_usage_optimization -v
```

#### **ğŸ›¡ï¸ é”™è¯¯å¤„ç†å’Œå¥å£®æ€§éªŒè¯**
```bash
# 1. é”™è¯¯å¤„ç†å•å…ƒæµ‹è¯•
pytest -k "error" -v

# 2. é”™è¯¯æ¢å¤é›†æˆæµ‹è¯•
pytest tests/integration/test_phase4_integration.py::TestPhase4Integration::test_error_handling_and_recovery -v

# 3. å¼‚å¸¸åœºæ™¯ç«¯åˆ°ç«¯æµ‹è¯•
pytest tests/e2e/test_complete_workflow.py::TestCompleteWorkflow::test_error_scenario_handling -v
```

### ğŸ“Š **CI/CDé›†æˆå»ºè®®**

#### **æ‹‰å–è¯·æ±‚ (PR) éªŒè¯**
```yaml
# .github/workflows/pr-validation.yml
- name: å¿«é€ŸéªŒè¯
  run: python run_tests.py --quick
  
- name: æ ¸å¿ƒé›†æˆæµ‹è¯•
  run: pytest -m "integration and not slow" --cov

- name: çœŸå®æ•°æ®æŠ½æ ·éªŒè¯
  run: python run_enhanced_tests.py --mode quick
```

#### **ä¸»åˆ†æ”¯é›†æˆéªŒè¯**
```yaml
# .github/workflows/main-integration.yml  
- name: å®Œæ•´æµ‹è¯•å¥—ä»¶
  run: python run_tests.py --full

- name: çœŸå®æ•°æ®å®Œæ•´éªŒè¯
  run: python run_enhanced_tests.py --all

- name: æ€§èƒ½åŸºå‡†æ£€æŸ¥
  run: pytest -m performance
```

#### **å‘å¸ƒéªŒè¯**
```yaml
# .github/workflows/release.yml
- name: ç”Ÿäº§å°±ç»ªéªŒè¯
  run: |
    python run_tests.py --full --parallel
    python validate_samples.py
    pytest --cov --cov-fail-under=90
```

---

## âœ… **æ€»ç»“å’Œå»ºè®®**

### ğŸ¯ **æµ‹è¯•ä½“ç³»ä¼˜åŠ¿**
1. **ğŸ“Š å®Œæ•´è¦†ç›–**: 288ä¸ªæµ‹è¯•å‡½æ•°ï¼Œè¦†ç›–æ ¸å¿ƒåŠŸèƒ½åˆ°çœŸå®åœºæ™¯
2. **ğŸ—ï¸ åˆ†å±‚æ¶æ„**: å•å…ƒâ†’é›†æˆâ†’ç«¯åˆ°ç«¯â†’çœŸå®æ•°æ®çš„å®Œæ•´æµ‹è¯•é‡‘å­—å¡”
3. **ğŸ› ï¸ ç»Ÿä¸€åŸºç¡€è®¾æ–½**: 4ä¸ªæµ‹è¯•å·¥å…·ç±»ï¼Œæ¶ˆé™¤é‡å¤ä»£ç 
4. **âš¡ çµæ´»æ‰§è¡Œ**: 10ä¸ªæµ‹è¯•æ ‡è®°ï¼Œæ”¯æŒå¤šç§æ‰§è¡Œç­–ç•¥
5. **ğŸ“ˆ è´¨é‡ç›‘æ§**: è¦†ç›–ç‡ã€æ€§èƒ½ã€çœŸå®æ•°æ®å¤šç»´åº¦è´¨é‡ä¿è¯

### ğŸš€ **æŒç»­æ”¹è¿›å»ºè®®**
1. **æå‡è¦†ç›–ç‡**: ä»87.3%æå‡åˆ°90%+ç›®æ ‡
2. **å¢åŠ æ ·æœ¬å¤šæ ·æ€§**: æ·»åŠ æ›´å¤šè¾¹ç¼˜æ¡ˆä¾‹å’Œå¤æ‚å°è£…
3. **æ€§èƒ½åŸºå‡†ä¼˜åŒ–**: å»ºç«‹æ›´ç»†ç²’åº¦çš„æ€§èƒ½é˜ˆå€¼ä½“ç³»
4. **è‡ªåŠ¨åŒ–æ‰©å±•**: é›†æˆåˆ°CI/CDæµæ°´çº¿çš„è‡ªåŠ¨è´¨é‡é—¨ç¦

### ğŸ‰ **æŒç»­æµ‹è¯•æœ€ä½³å®è·µ**
1. **å¼€å‘æ—¶**: ä½¿ç”¨ `python run_tests.py --quick` å¿«é€ŸéªŒè¯
2. **é›†æˆæ—¶**: ä½¿ç”¨ `python run_tests.py --type integration` ç»„ä»¶éªŒè¯
3. **å‘å¸ƒå‰**: ä½¿ç”¨ `python run_enhanced_tests.py --all` å®Œæ•´éªŒè¯
4. **ç”Ÿäº§éƒ¨ç½²**: ä½¿ç”¨å…¨å¥—æµ‹è¯• + æ€§èƒ½åŸºå‡†ç¡®ä¿è´¨é‡

**PktMaskçš„æµ‹è¯•ä½“ç³»å·²å…·å¤‡ä¼ä¸šçº§æ ‡å‡†ï¼Œæ”¯æŒæŒç»­é›†æˆå’Œé«˜è´¨é‡äº¤ä»˜ã€‚** ğŸ¯