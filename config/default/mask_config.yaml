# 新版双模块架构配置
protocol: tls
mode: enhanced

# Marker模块配置
marker_config:
  tls:
    preserve_handshake: true
    preserve_application_data: false
    preserve_alert: true
    preserve_change_cipher_spec: true
    preserve_heartbeat: true
  tshark_path: null  # 自动检测
  decode_as: []

# Masker模块配置
masker_config:
  chunk_size: 1000
  verify_checksums: true
  enable_performance_monitoring: true
  enable_error_recovery: true

# TShark工具配置
tools:
  tshark:
    custom_executable: null
    enable_defragmentation: true
    enable_reassembly: true
    executable_paths:
    - /usr/bin/tshark
    - /usr/local/bin/tshark
    - /opt/wireshark/bin/tshark
    - C:\Program Files\Wireshark\tshark.exe
    - C:\Program Files (x86)\Wireshark\tshark.exe
    - /Applications/Wireshark.app/Contents/MacOS/tshark
    max_memory_mb: 1024
    quiet_mode: true
    timeout_seconds: 300
