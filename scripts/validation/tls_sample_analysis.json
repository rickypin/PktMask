{
  "metadata": {
    "file": "/Users/ricky/Downloads/PktMask/tests/data/tls-single/tls_sample.pcap",
    "analysis_time": "2025-06-23T13:37:09.449197",
    "analyzer_version": "1.0"
  },
  "summary": {
    "total_packets": 22,
    "tcp_packets": 22,
    "flows": [
      {
        "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
        "packet_count": 12,
        "packet_numbers": [
          1,
          3,
          4,
          8,
          9,
          11,
          13,
          14,
          16,
          17,
          21,
          22
        ],
        "sequence_start": 2422049781,
        "sequence_end": 2422050661,
        "total_payload_bytes": 879
      },
      {
        "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
        "packet_count": 10,
        "packet_numbers": [
          2,
          5,
          6,
          7,
          10,
          12,
          15,
          18,
          19,
          20
        ],
        "sequence_start": 3913402950,
        "sequence_end": 3913404957,
        "total_payload_bytes": 2006
      }
    ],
    "sequence_ranges": {
      "TCP_10.171.250.80:33492_10.50.50.161:443_forward": {
        "min": 2422049781,
        "max": 2422050661
      },
      "TCP_10.171.250.80:33492_10.50.50.161:443_reverse": {
        "min": 3913402950,
        "max": 3913404957
      }
    },
    "tls_distribution": {
      "Handshake": 4,
      "Unknown(88)": 1,
      "ChangeCipherSpec": 1,
      "ApplicationData": 2,
      "Alert": 2
    }
  },
  "packets": [
    {
      "packet_number": 1,
      "timestamp": 1739953296.645501,
      "size": 74,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422049781,
      "ack": 0,
      "flags": "S",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 2,
      "timestamp": 1739953296.941416,
      "size": 74,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913402950,
      "ack": 2422049782,
      "flags": "SA",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 3,
      "timestamp": 1739953296.941416,
      "size": 66,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422049782,
      "ack": 3913402951,
      "flags": "A",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 4,
      "timestamp": 1739953296.941416,
      "size": 583,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422049782,
      "ack": 3913402951,
      "flags": "PA",
      "payload_length": 517,
      "payload_preview": "1603010200010001fc030334324e1722",
      "has_payload": true,
      "tls_content_type": 22,
      "tls_type": "Handshake",
      "tls_version": "0x0301",
      "tls_record_length": 512,
      "tls_handshake_type": 1,
      "tls_handshake_name": "ClientHello",
      "notes": "TLS ClientHello"
    },
    {
      "packet_number": 5,
      "timestamp": 1739953297.020306,
      "size": 66,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913402951,
      "ack": 2422049782,
      "flags": "A",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 6,
      "timestamp": 1739953297.024065,
      "size": 1408,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913402951,
      "ack": 2422050299,
      "flags": "A",
      "payload_length": 1342,
      "payload_preview": "16030307100200004d0303abab4cccc8",
      "has_payload": true,
      "tls_content_type": 22,
      "tls_type": "Handshake",
      "tls_version": "0x0303",
      "tls_record_length": 1808,
      "tls_handshake_type": 2,
      "tls_handshake_name": "ServerHello",
      "notes": "TLS ServerHello"
    },
    {
      "packet_number": 7,
      "timestamp": 1739953297.024296,
      "size": 537,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913404293,
      "ack": 2422050299,
      "flags": "PA",
      "payload_length": 471,
      "payload_preview": "58ddf68b0b710c0001c9030017410428",
      "has_payload": true,
      "tls_content_type": 88,
      "tls_type": "Unknown(88)",
      "tls_version": "0xddf6",
      "tls_record_length": 35595,
      "notes": "TLS Unknown(88)"
    },
    {
      "packet_number": 8,
      "timestamp": 1739953297.025396,
      "size": 66,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050299,
      "ack": 3913404764,
      "flags": "A",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 9,
      "timestamp": 1739953297.026958,
      "size": 192,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050299,
      "ack": 3913404764,
      "flags": "PA",
      "payload_length": 126,
      "payload_preview": "16030300461000004241045e3adf208c",
      "has_payload": true,
      "tls_content_type": 22,
      "tls_type": "Handshake",
      "tls_version": "0x0303",
      "tls_record_length": 70,
      "tls_handshake_type": 16,
      "tls_handshake_name": "ClientKeyExchange",
      "notes": "TLS ClientKeyExchange"
    },
    {
      "packet_number": 10,
      "timestamp": 1739953297.101993,
      "size": 72,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913404764,
      "ack": 2422050425,
      "flags": "PA",
      "payload_length": 6,
      "payload_preview": "140303000101",
      "has_payload": true,
      "tls_content_type": 20,
      "tls_type": "ChangeCipherSpec",
      "tls_version": "0x0303",
      "tls_record_length": 1,
      "notes": "TLS ChangeCipherSpec"
    },
    {
      "packet_number": 11,
      "timestamp": 1739953297.142473,
      "size": 66,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050425,
      "ack": 3913404770,
      "flags": "A",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 12,
      "timestamp": 1739953297.206658,
      "size": 111,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913404770,
      "ack": 2422050425,
      "flags": "PA",
      "payload_length": 45,
      "payload_preview": "16030300280000000000000000879c51",
      "has_payload": true,
      "tls_content_type": 22,
      "tls_type": "Handshake",
      "tls_version": "0x0303",
      "tls_record_length": 40,
      "tls_handshake_type": 0,
      "tls_handshake_name": "HelloRequest",
      "notes": "TLS HelloRequest"
    },
    {
      "packet_number": 13,
      "timestamp": 1739953297.206658,
      "size": 66,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050425,
      "ack": 3913404815,
      "flags": "A",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 14,
      "timestamp": 1739953297.206658,
      "size": 271,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050425,
      "ack": 3913404815,
      "flags": "PA",
      "payload_length": 205,
      "payload_preview": "17030300a91b955d6156ef5b870467a7",
      "has_payload": true,
      "tls_content_type": 23,
      "tls_type": "ApplicationData",
      "tls_version": "0x0303",
      "tls_record_length": 169,
      "notes": "TLS应用数据"
    },
    {
      "packet_number": 15,
      "timestamp": 1739953297.260583,
      "size": 177,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913404815,
      "ack": 2422050630,
      "flags": "PA",
      "payload_length": 111,
      "payload_preview": "170303006a0000000000000001731224",
      "has_payload": true,
      "tls_content_type": 23,
      "tls_type": "ApplicationData",
      "tls_version": "0x0303",
      "tls_record_length": 106,
      "notes": "TLS应用数据"
    },
    {
      "packet_number": 16,
      "timestamp": 1739953297.262132,
      "size": 97,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050630,
      "ack": 3913404926,
      "flags": "PA",
      "payload_length": 31,
      "payload_preview": "150303001a1b955d6156ef5b89c94133",
      "has_payload": true,
      "tls_content_type": 21,
      "tls_type": "Alert",
      "tls_version": "0x0303",
      "tls_record_length": 26,
      "notes": "TLS Alert"
    },
    {
      "packet_number": 17,
      "timestamp": 1739953297.262361,
      "size": 66,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050661,
      "ack": 3913404926,
      "flags": "FA",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 18,
      "timestamp": 1739953297.326384,
      "size": 66,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913404926,
      "ack": 2422050662,
      "flags": "A",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 19,
      "timestamp": 1739953297.32714,
      "size": 97,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913404926,
      "ack": 2422050662,
      "flags": "PA",
      "payload_length": 31,
      "payload_preview": "150303001a0000000000000002ab8b53",
      "has_payload": true,
      "tls_content_type": 21,
      "tls_type": "Alert",
      "tls_version": "0x0303",
      "tls_record_length": 26,
      "notes": "TLS Alert"
    },
    {
      "packet_number": 20,
      "timestamp": 1739953297.32714,
      "size": 66,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_reverse",
      "direction": "reverse",
      "src_ip": "10.50.50.161",
      "dst_ip": "10.171.250.80",
      "src_port": 443,
      "dst_port": 33492,
      "sequence": 3913404957,
      "ack": 2422050662,
      "flags": "FA",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 21,
      "timestamp": 1739953297.328217,
      "size": 60,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050662,
      "ack": 0,
      "flags": "R",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    },
    {
      "packet_number": 22,
      "timestamp": 1739953297.328217,
      "size": 60,
      "protocol": "TCP",
      "stream_id": "TCP_10.171.250.80:33492_10.50.50.161:443_forward",
      "direction": "forward",
      "src_ip": "10.171.250.80",
      "dst_ip": "10.50.50.161",
      "src_port": 33492,
      "dst_port": 443,
      "sequence": 2422050662,
      "ack": 0,
      "flags": "R",
      "payload_length": 0,
      "payload_preview": "",
      "has_payload": false
    }
  ]
}