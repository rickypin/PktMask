{
  "gui_flow": {
    "name": "GUI调用流程",
    "steps": [
      {
        "step": "step_1",
        "description": "MainWindow复选框状态模拟",
        "data": null,
        "timestamp": 1752474570.6562738
      },
      {
        "step": "step_2",
        "description": "PipelineManager.toggle_pipeline_processing()调用",
        "data": null,
        "timestamp": 1752474570.656312
      },
      {
        "step": "step_3",
        "description": "build_pipeline_config()调用",
        "data": null,
        "timestamp": 1752474570.6563132
      },
      {
        "step": "step_4",
        "description": "create_pipeline_executor()调用",
        "data": null,
        "timestamp": 1752474570.6904068
      },
      {
        "step": "step_5",
        "description": "PipelineExecutor._build_pipeline()内部处理",
        "data": null,
        "timestamp": 1752474571.572911
      },
      {
        "step": "step_6",
        "description": "NewMaskPayloadStage实例化",
        "data": null,
        "timestamp": 1752474571.572973
      },
      {
        "step": "step_7",
        "description": "ServicePipelineThread创建和启动",
        "data": null,
        "timestamp": 1752474571.573028
      },
      {
        "step": "step_8",
        "description": "process_directory()调用",
        "data": null,
        "timestamp": 1752474571.573029
      },
      {
        "step": "step_9",
        "description": "executor.run()调用",
        "data": null,
        "timestamp": 1752474571.573029
      },
      {
        "step": "step_10",
        "description": "结果收集和统计",
        "data": null,
        "timestamp": 1752474572.63057
      },
      {
        "step": "step_11",
        "description": "GUI事件处理和UI更新",
        "data": null,
        "timestamp": 1752474572.630744
      }
    ],
    "configs": {
      "checkbox_states": {
        "mask_ip_cb": false,
        "dedup_packet_cb": false,
        "mask_payload_cb": true
      },
      "pipeline_config": {
        "mask": {
          "enabled": true,
          "protocol": "tls",
          "mode": "enhanced",
          "marker_config": {
            "tls": {
              "preserve_handshake": true,
              "preserve_application_data": false
            }
          },
          "masker_config": {
            "preserve_ratio": 0.3
          }
        }
      },
      "extracted_mask_config": {
        "enabled": true,
        "protocol": "tls",
        "mode": "enhanced",
        "marker_config": {
          "tls": {
            "preserve_handshake": true,
            "preserve_application_data": false
          }
        },
        "masker_config": {
          "preserve_ratio": 0.3
        }
      }
    },
    "objects": {
      "pipeline_executor": {
        "class_name": "PipelineExecutor",
        "stages_count": 1,
        "stage_names": [
          "NewMaskPayloadStage"
        ]
      },
      "mask_stage": {
        "class_name": "NewMaskPayloadStage",
        "protocol": "tls",
        "mode": "enhanced",
        "marker_config": {
          "tls": {
            "preserve_handshake": true,
            "preserve_application_data": false
          }
        },
        "masker_config": {
          "preserve_ratio": 0.3
        },
        "initialized": true
      }
    },
    "results": {
      "execution_result": {
        "success": true,
        "errors": [],
        "duration_ms": 1056.6210746765137,
        "stage_stats_count": 1
      }
    }
  },
  "direct_flow": {
    "name": "直接调用流程",
    "steps": [
      {
        "step": "step_1",
        "description": "直接配置创建",
        "data": null,
        "timestamp": 1752474572.630826
      },
      {
        "step": "step_2",
        "description": "NewMaskPayloadStage直接实例化",
        "data": null,
        "timestamp": 1752474572.63087
      },
      {
        "step": "step_3",
        "description": "Stage.initialize()调用",
        "data": null,
        "timestamp": 1752474572.630976
      },
      {
        "step": "step_4",
        "description": "process_file()直接调用",
        "data": null,
        "timestamp": 1752474572.812282
      },
      {
        "step": "step_5",
        "description": "结果收集",
        "data": null,
        "timestamp": 1752474573.7818701
      }
    ],
    "configs": {
      "direct_config": {
        "enabled": true,
        "protocol": "tls",
        "mode": "enhanced",
        "marker_config": {
          "tls": {
            "preserve_handshake": true,
            "preserve_application_data": false
          }
        },
        "masker_config": {
          "preserve_ratio": 0.3
        }
      }
    },
    "objects": {
      "mask_stage": {
        "class_name": "NewMaskPayloadStage",
        "protocol": "tls",
        "mode": "enhanced",
        "marker_config": {
          "tls": {
            "preserve_handshake": true,
            "preserve_application_data": false
          }
        },
        "masker_config": {
          "preserve_ratio": 0.3
        },
        "initialized": false
      }
    },
    "results": {
      "initialization": {
        "success": true
      },
      "execution_result": {
        "stage_name": "Mask Payloads (v2)",
        "packets_processed": 31,
        "packets_modified": 10,
        "duration_ms": 19.10400390625,
        "extra_metrics": {
          "masked_bytes": 2108,
          "preserved_bytes": 1128,
          "masking_ratio": 0.6514215080346106,
          "preservation_ratio": 0.34857849196538937,
          "processing_speed_mbps": 0.1615415335463259,
          "protocol": "tls",
          "mode": "enhanced",
          "success": true,
          "errors": [],
          "warnings": []
        }
      }
    }
  },
  "comparison": {
    "flow_structure": {
      "gui_flow": [
        "step_1",
        "step_2",
        "step_3",
        "step_4",
        "step_5",
        "step_6",
        "step_7",
        "step_8",
        "step_9",
        "step_10",
        "step_11"
      ],
      "direct_flow": [
        "step_1",
        "step_2",
        "step_3",
        "step_4",
        "step_5"
      ],
      "gui_unique_steps": [
        "step_6",
        "step_11",
        "step_10",
        "step_7",
        "step_8",
        "step_9"
      ],
      "direct_unique_steps": []
    },
    "config_differences": {},
    "object_differences": {
      "mask_stage": {
        "initialized": {
          "gui": true,
          "direct": false
        }
      }
    },
    "result_differences": {
      "mask_stats": {
        "packets_processed": {
          "gui": null,
          "direct": 31
        },
        "packets_modified": {
          "gui": null,
          "direct": 10
        },
        "duration_ms": {
          "gui": null,
          "direct": 19.10400390625
        }
      }
    },
    "step_count": {
      "gui": 11,
      "direct": 5,
      "difference": 6
    },
    "key_differences": [
      "MaskStage对象属性不同",
      "执行结果统计不同",
      "GUI有额外的处理步骤"
    ]
  }
}