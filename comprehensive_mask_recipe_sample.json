{
  "total_packets": 50,
  "metadata": {
    "recipe_name": "综合掩码策略演示配方",
    "version": "1.0",
    "description": "展示TCP载荷掩码器的各种掩码策略和应用场景",
    "author": "PktMask示例",
    "created_date": "2025-06-24",
    "use_cases": [
      "HTTP协议载荷掩码",
      "TLS握手保留",
      "数据载荷部分掩码",
      "敏感信息范围掩码",
      "协议头部保护"
    ],
    "network_protocols": ["HTTP", "HTTPS", "TLS", "TCP"],
    "mask_strategies": {
      "preserve_headers": "保留协议头部信息",
      "mask_payload": "掩码应用数据载荷", 
      "selective_masking": "选择性掩码敏感字段",
      "full_preservation": "完全保留关键包"
    }
  },
  "instructions": [
    {
      "packet_index": 0,
      "packet_timestamp": "1739953296.645501",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TCP握手包 - 完全保留"
    },
    {
      "packet_index": 1,
      "packet_timestamp": "1739953296.941416",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TCP握手确认包 - 完全保留"
    },
    {
      "packet_index": 2,
      "packet_timestamp": "1739953296.941416",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TCP握手完成包 - 完全保留"
    },
    {
      "packet_index": 3,
      "packet_timestamp": "1739953296.941416",
      "payload_offset": 54,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 20
      },
      "comment": "HTTP请求 - 保留前20字节(方法+URL)，掩码其余部分"
    },
    {
      "packet_index": 4,
      "packet_timestamp": "1739953297.020306",
      "payload_offset": 54,
      "mask_spec_type": "MaskRange",
      "mask_spec_params": {
        "ranges": [
          {"start": 50, "end": 100},
          {"start": 150, "end": 200}
        ]
      },
      "comment": "HTTP请求体 - 选择性掩码用户数据字段"
    },
    {
      "packet_index": 5,
      "packet_timestamp": "1739953297.024065",
      "payload_offset": 54,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 15
      },
      "comment": "HTTP响应 - 保留状态行，掩码响应体"
    },
    {
      "packet_index": 6,
      "packet_timestamp": "1739953297.024296",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TLS Client Hello - 完全保留握手信息"
    },
    {
      "packet_index": 7,
      "packet_timestamp": "1739953297.025396",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TLS Server Hello - 完全保留握手信息"
    },
    {
      "packet_index": 8,
      "packet_timestamp": "1739953297.026958",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TLS Certificate - 完全保留证书信息"
    },
    {
      "packet_index": 9,
      "packet_timestamp": "1739953297.101993",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TLS Server Hello Done - 完全保留"
    },
    {
      "packet_index": 10,
      "packet_timestamp": "1739953297.142473",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TLS Client Key Exchange - 完全保留"
    },
    {
      "packet_index": 11,
      "packet_timestamp": "1739953297.206658",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TLS Change Cipher Spec - 完全保留"
    },
    {
      "packet_index": 12,
      "packet_timestamp": "1739953297.206658",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TLS Finished - 完全保留"
    },
    {
      "packet_index": 13,
      "packet_timestamp": "1739953297.206658",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "TLS Change Cipher Spec (Server) - 完全保留"
    },
    {
      "packet_index": 14,
      "packet_timestamp": "1739953297.260583",
      "payload_offset": 54,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 5
      },
      "comment": "TLS Application Data - 保留前5字节(TLS头)，掩码应用数据"
    },
    {
      "packet_index": 15,
      "packet_timestamp": "1739953297.262132",
      "payload_offset": 54,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 5
      },
      "comment": "TLS Application Data - 保留前5字节(TLS头)，掩码应用数据"
    },
    {
      "packet_index": 16,
      "packet_timestamp": "1739953297.262361",
      "payload_offset": 54,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 5
      },
      "comment": "TLS Application Data - 保留前5字节(TLS头)，掩码应用数据"
    },
    {
      "packet_index": 17,
      "packet_timestamp": "1739953297.326384",
      "payload_offset": 54,
      "mask_spec_type": "MaskRange",
      "mask_spec_params": {
        "ranges": [
          {"start": 10, "end": 30},
          {"start": 40, "end": 80},
          {"start": 100, "end": 150}
        ]
      },
      "comment": "大数据包 - 选择性掩码多个敏感数据段"
    },
    {
      "packet_index": 18,
      "packet_timestamp": "1739953297.327140",
      "payload_offset": 66,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 8
      },
      "comment": "VLAN封装包 - 调整载荷偏移量，保留前8字节"
    },
    {
      "packet_index": 19,
      "packet_timestamp": "1739953297.400123",
      "payload_offset": 42,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 12
      },
      "comment": "IPv6包 - 调整载荷偏移量(IPv6头部更长)"
    },
    {
      "packet_index": 20,
      "packet_timestamp": "1739953297.450234",
      "payload_offset": 54,
      "mask_spec_type": "MaskRange",
      "mask_spec_params": {
        "ranges": [
          {"start": 0, "end": 10}
        ]
      },
      "comment": "只掩码载荷开头10字节，保留其余所有数据"
    },
    {
      "packet_index": 25,
      "packet_timestamp": "1739953298.100456",
      "payload_offset": 54,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 0
      },
      "comment": "完全掩码载荷 - 载荷全部置零"
    },
    {
      "packet_index": 30,
      "packet_timestamp": "1739953298.200567",
      "payload_offset": 54,
      "mask_spec_type": "MaskRange",
      "mask_spec_params": {
        "ranges": [
          {"start": 16, "end": 32},
          {"start": 48, "end": 64},
          {"start": 80, "end": 96}
        ]
      },
      "comment": "密码字段掩码 - 掩码固定位置的密码或令牌字段"
    },
    {
      "packet_index": 35,
      "packet_timestamp": "1739953298.300678",
      "payload_offset": 58,
      "mask_spec_type": "MaskAfter",
      "mask_spec_params": {
        "keep_bytes": 24
      },
      "comment": "MPLS封装包 - 调整载荷偏移量以适应MPLS标签"
    },
    {
      "packet_index": 40,
      "packet_timestamp": "1739953298.400789",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "FIN包 - 连接终止包，完全保留"
    },
    {
      "packet_index": 45,
      "packet_timestamp": "1739953298.500890",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "ACK包 - 确认包，完全保留"
    },
    {
      "packet_index": 49,
      "packet_timestamp": "1739953298.600991",
      "payload_offset": 54,
      "mask_spec_type": "KeepAll",
      "mask_spec_params": {},
      "comment": "最后一个包 - 完全保留以确保连接正常关闭"
    }
  ],
  "usage_notes": {
    "payload_offset_explanation": {
      "54": "标准以太网(14) + IPv4(20) + TCP(20)头部长度",
      "66": "VLAN封装: 以太网(14) + VLAN(4) + IPv4(20) + TCP(20) + 额外头部(8)",
      "42": "IPv6: 以太网(14) + IPv6(40) + TCP(20) - IPv4头部差异(-12)",
      "58": "MPLS: 以太网(14) + MPLS(4) + IPv4(20) + TCP(20)"
    },
    "mask_strategy_guidelines": {
      "handshake_packets": "TCP/TLS握手包建议使用KeepAll完全保留",
      "application_data": "应用数据包建议使用MaskAfter保留协议头部",
      "sensitive_fields": "敏感字段建议使用MaskRange精确掩码",
      "control_packets": "控制包(FIN/RST/ACK)建议完全保留"
    },
    "testing_recommendations": {
      "step1": "先使用--analyze-recipe分析配方结构",
      "step2": "小批量测试验证掩码效果",
      "step3": "使用网络分析工具验证输出包结构",
      "step4": "确认应用程序仍能正常解析掩码后的包"
    }
  }
} 