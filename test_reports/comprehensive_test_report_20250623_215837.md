# TCP载荷掩码器综合测试报告

**测试时间**: 2025-06-23 21:58:37
**测试样本**: `tests/data/tls-single/tls_sample.pcap`

## 📊 测试概览

- **总场景数**: 7
- **成功场景数**: 0
- **成功率**: 0.0%
- **平均准确率**: 40.4%
- **平均执行时间**: 0.33秒
- **总执行时间**: 2.29秒

## 🎯 场景测试结果

### scenario_01_single_packet
- **状态**: ❌ 失败
- **描述**: 验证对单个TLS ClientHello包(包4)的精确序列号匹配，保留TLS记录头部信息
- **执行时间**: 0.32秒
- **预期修改包数**: 1
- **实际修改包数**: 0
- **准确率**: 50.0%

### scenario_02_range_match
- **状态**: ❌ 失败
- **描述**: 验证对TLS握手过程中多个包的范围匹配，包括ClientHello和ServerHello
- **执行时间**: 0.31秒
- **预期修改包数**: 2
- **实际修改包数**: 0
- **准确率**: 49.9%

### scenario_03_tls_application_data
- **状态**: ❌ 失败
- **描述**: 验证对TLS ApplicationData包(包14和包15)的掩码处理，只保留TLS记录头
- **执行时间**: 0.31秒
- **预期修改包数**: 2
- **实际修改包数**: 0
- **准确率**: 50.0%

### scenario_04_bidirectional_flows
- **状态**: ❌ 失败
- **描述**: 验证正向流和反向流的独立处理，确保流方向正确识别和独立掩码
- **执行时间**: 0.32秒
- **预期修改包数**: 4
- **实际修改包数**: 0
- **准确率**: 42.4%

### scenario_05_boundary_conditions
- **状态**: ❌ 失败
- **描述**: 测试序列号边界匹配、保留范围边界和特殊载荷长度的处理
- **执行时间**: 0.31秒
- **预期修改包数**: 3
- **实际修改包数**: 0
- **准确率**: 20.2%

### scenario_06_mixed_protocols
- **状态**: ❌ 失败
- **描述**: 验证对不同类型TLS包（握手、应用数据、警告）应用不同掩码策略
- **执行时间**: 0.42秒
- **预期修改包数**: 3
- **实际修改包数**: 0
- **准确率**: 43.8%

### scenario_07_comprehensive
- **状态**: ❌ 失败
- **描述**: 综合测试双向流、多种协议类型、不同保留策略的复杂组合
- **执行时间**: 0.31秒
- **预期修改包数**: 6
- **实际修改包数**: 0
- **准确率**: 26.5%

## ⚡ 性能指标

- **平均处理速度**: 67 pps
- **最快场景**: 0.31秒
- **最慢场景**: 0.42秒

## 💡 测试总结

🚨 **测试结果需要改进**：多个场景测试失败，需要重点修复相关功能。

### 改进建议
- 提高序列号匹配精度
- 重点检查失败的 7 个测试场景